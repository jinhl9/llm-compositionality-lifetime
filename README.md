# Geometric Signatures of Compositionality Across a Language Model's Lifetime
A codebase for ["Geometric Signatures of Compositionality Across a Language Model's Lifetime"](https://arxiv.org/abs/2410.01444), ACL 2025

Jin Hwa Lee*, Thomas Jiralerspong*, Lei Yu, Yoshua Bengio, Emily Cheng.

*Equal contribution, co-first authors

## Repo overview
- **data/** <br /> A collection of prompts generated by controlled grammar and categorized lexical items. **compute_unigram.py** is used to check the unigram distribution of the used words.
- **constants.py** <br /> Include lexical items for each category to generate the prompts with contolled grammar.
- **train_test_splits_lengths/** <br /> Ablation prompts of different legnths. 
- **generate_train_test_split.py** <br /> From the generated prompts, define train and test set split.
- **run_pipeline.py** <br /> A script to extract feature complexities from synthetic dataset.
- **run_pipeline_pile.py** <br /> A script to extract feature complexities from The Pile.
- **utils.py** <br /> Utility functions for the main pipeline. 
- **collect_to_csv.py** <br /> Processing all extracted feature complexities into .csv file for downtream analysis.
- **pythia_eval.py** <br /> A script to collect the downstream task performance of [Pythia models across pretraining checkpoints](https://github.com/EleutherAI/pythia) generating **task_performance_summary.csv**.
- **static_plotting.py** <br /> A script for static analysis (the last checkpoints).
- **dynamics_plotting.py** <br /> A script for dynamic analsis (across the checkpoints).
- **id_results_all.csv** <br /> Collected feature complexities used for the analysis.


